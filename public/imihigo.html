<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imihigo Management | DUHIGURE MU MIRYANGO</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- FullCalendar CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        .imihigo-card {
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            transition: transform 0.3s;
        }
        
        .imihigo-card:hover {
            transform: translateY(-5px);
        }
        
        .imihigo-header {
            padding: 15px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .imihigo-individual {
            background: linear-gradient(135deg, #198754 0%, #146c43 100%);
        }
        
        .imihigo-family {
            background: linear-gradient(135deg, #0d6efd 0%, #0b5ed7 100%);
        }
        
        .imihigo-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .status-pending { background: #ffc107; color: #000; }
        .status-inprogress { background: #0dcaf0; color: #000; }
        .status-completed { background: #198754; color: #fff; }
        .status-delayed { background: #dc3545; color: #fff; }
        
        .progress-indicator {
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar {
            height: 100%;
            transition: width 0.3s;
        }
        
        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .fc-event {
            cursor: pointer;
        }
        
        .stats-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            color: white;
            margin-bottom: 20px;
        }
        
        .stats-total { background: #198754; }
        .stats-completed { background: #20c997; }
        .stats-progress { background: #0dcaf0; }
        .stats-delayed { background: #dc3545; }
    </style>
</head>

<body>
    <!-- Navigation -->
    <div id="navbar-placeholder"></div>

    <!-- Page Header -->
    <section class="page-header bg-success text-white py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold">Imihigo Management</h1>
                    <p class="lead">Manage your family's performance duties and track progress</p>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-lg-end">
                            <li class="breadcrumb-item"><a href="index.html" class="text-white-50">Home</a></li>
                            <li class="breadcrumb-item"><a href="system.html" class="text-white-50">Family</a></li>
                            <li class="breadcrumb-item active text-white" aria-current="page">Imihigo</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </section>

    <!-- Statistics -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <div class="stats-card stats-total">
                        <i class="bi bi-list-task display-4 mb-2"></i>
                        <h3 id="totalImihigo">15</h3>
                        <p class="mb-0">Total Imihigo</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card stats-completed">
                        <i class="bi bi-check-circle display-4 mb-2"></i>
                        <h3 id="completedImihigo">8</h3>
                        <p class="mb-0">Completed</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card stats-progress">
                        <i class="bi bi-arrow-clockwise display-4 mb-2"></i>
                        <h3 id="inProgressImihigo">5</h3>
                        <p class="mb-0">In Progress</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card stats-delayed">
                        <i class="bi bi-clock-history display-4 mb-2"></i>
                        <h3 id="delayedImihigo">2</h3>
                        <p class="mb-0">Delayed</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <!-- Imihigo List -->
                <div class="col-lg-8">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="text-success">Your Imihigo</h2>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addImihigoModal">
                            <i class="bi bi-plus-circle"></i> Add New Imihigo
                        </button>
                    </div>
                    
                    <!-- Filter Tabs -->
                    <ul class="nav nav-tabs mb-4" id="imihigoTabs">
                        <li class="nav-item">
                            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#all-imihigo">
                                All Imihigo
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#individual-imihigo">
                                Individual
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#family-imihigo">
                                Family Shared
                            </button>
                        </li>
                    </ul>
                    
                    <!-- Tab Content -->
                    <div class="tab-content" id="imihigoTabContent">
                        <!-- All Imihigo -->
                        <div class="tab-pane fade show active" id="all-imihigo">
                            <div id="imihigoList">
                                <!-- Imihigo cards will be loaded here -->
                            </div>
                        </div>
                        
                        <!-- Individual Imihigo -->
                        <div class="tab-pane fade" id="individual-imihigo">
                            <div id="individualImihigoList">
                                <!-- Individual Imihigo cards -->
                            </div>
                        </div>
                        
                        <!-- Family Imihigo -->
                        <div class="tab-pane fade" id="family-imihigo">
                            <div id="familyImihigoList">
                                <!-- Family Imihigo cards -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Calendar & Quick Actions -->
                <div class="col-lg-4">
                    <!-- Calendar -->
                    <div class="calendar-container mb-4">
                        <h5 class="text-success mb-3"><i class="bi bi-calendar"></i> Imihigo Calendar</h5>
                        <div id="calendar"></div>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5 class="text-success"><i class="bi bi-graph-up"></i> Quick Stats</h5>
                            <div class="mt-3">
                                <p><strong>Completion Rate:</strong> <span id="completionRate">73%</span></p>
                                <div class="progress-indicator">
                                    <div class="progress-bar bg-success" style="width: 73%"></div>
                                </div>
                                
                                <p class="mt-3"><strong>Average Progress:</strong> <span id="avgProgress">68%</span></p>
                                <div class="progress-indicator">
                                    <div class="progress-bar bg-info" style="width: 68%"></div>
                                </div>
                                
                                <p class="mt-3"><strong>On-Time Completion:</strong> <span id="onTimeRate">85%</span></p>
                                <div class="progress-indicator">
                                    <div class="progress-bar bg-primary" style="width: 85%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="card">
                        <div class="card-body">
                            <h5 class="text-success"><i class="bi bi-lightning"></i> Quick Actions</h5>
                            <div class="d-grid gap-2 mt-3">
                                <button class="btn btn-outline-success" onclick="updateAllProgress()">
                                    <i class="bi bi-arrow-clockwise"></i> Update Progress
                                </button>
                                <button class="btn btn-outline-success" onclick="generateReport()">
                                    <i class="bi bi-file-earmark-text"></i> Generate Report
                                </button>
                                <button class="btn btn-outline-success" onclick="shareAchievements()">
                                    <i class="bi bi-share"></i> Share Achievements
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="text-center text-success mb-5">Imihigo Categories</h2>
            
            <div class="row">
                <div class="col-md-3 mb-4">
                    <div class="card text-center h-100 border-success">
                        <div class="card-body">
                            <i class="bi bi-house display-4 text-success mb-3"></i>
                            <h5>Family Development</h5>
                            <p>Home improvement, family unity, parenting</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="card text-center h-100 border-success">
                        <div class="card-body">
                            <i class="bi bi-cash-coin display-4 text-success mb-3"></i>
                            <h5>Economic Growth</h5>
                            <p>Income generation, savings, investments</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="card text-center h-100 border-success">
                        <div class="card-body">
                            <i class="bi bi-book display-4 text-success mb-3"></i>
                            <h5>Education</h5>
                            <p>School performance, skills development</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="card text-center h-100 border-success">
                        <div class="card-body">
                            <i class="bi bi-heart-pulse display-4 text-success mb-3"></i>
                            <h5>Health & Wellness</h5>
                            <p>Healthcare, nutrition, exercise</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>Imihigo Management</h5>
                    <p>Track and manage your family's performance duties for sustainable development.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="guide.html#imihigo" class="text-white-50">How to Set Imihigo</a></li>
                        <li><a href="templates.html" class="text-white-50">Imihigo Templates</a></li>
                        <li><a href="success-stories.html" class="text-white-50">Success Stories</a></li>
                        <li><a href="contact.html" class="text-white-50">Get Support</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Need Help?</h5>
                    <p>Contact our Imihigo support team for guidance on setting and achieving your performance duties.</p>
                    <a href="contact.html" class="btn btn-outline-light btn-sm">Contact Support</a>
                </div>
            </div>
            <hr class="bg-white">
            <div class="text-center pt-3">
                &copy; 2025 DUHIGURE MU MIRYANGO | Imihigo Management System | www.duhigure.rw
            </div>
        </div>
    </footer>

    <!-- Add Imihigo Modal -->
    <div class="modal fade" id="addImihigoModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Imihigo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="imihigoForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Imihigo Type *</label>
                                <select class="form-select" id="imihigoType" required>
                                    <option value="">-- Select Type --</option>
                                    <option value="individual">Individual</option>
                                    <option value="family">Family Shared</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Assigned To</label>
                                <select class="form-select" id="assignedTo" disabled>
                                    <option value="">-- Select Member --</option>
                                    <option value="all">All Family Members</option>
                                    <option value="father">Father</option>
                                    <option value="mother">Mother</option>
                                    <option value="child1">Eric M.</option>
                                    <option value="child2">Alice U.</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Category *</label>
                            <select class="form-select" id="category" required>
                                <option value="">-- Select Category --</option>
                                <option value="family">Family Development</option>
                                <option value="economic">Economic Growth</option>
                                <option value="education">Education</option>
                                <option value="health">Health & Wellness</option>
                                <option value="agriculture">Agriculture</option>
                                <option value="community">Community Service</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Title *</label>
                            <input type="text" class="form-control" id="imihigoTitle" 
                                   placeholder="Enter Imihigo title" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Description *</label>
                            <textarea class="form-control" id="imihigoDescription" 
                                      rows="3" placeholder="Describe the Imihigo in detail" required></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Start Date *</label>
                                <input type="date" class="form-control" id="startDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Target Completion Date *</label>
                                <input type="date" class="form-control" id="targetDate" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Priority</label>
                                <select class="form-select" id="priority">
                                    <option value="low">Low</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Estimated Effort (Hours)</label>
                                <input type="number" class="form-control" id="estimatedEffort" 
                                       min="1" placeholder="e.g., 10">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Success Criteria *</label>
                            <textarea class="form-control" id="successCriteria" 
                                      rows="2" placeholder="How will success be measured?" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="saveImihigo">Save Imihigo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Progress Modal -->
    <div class="modal fade" id="updateProgressModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Update Progress</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="progressForm">
                        <input type="hidden" id="imihigoId">
                        <div class="mb-3">
                            <label class="form-label">Current Progress (%)</label>
                            <input type="range" class="form-range" id="progressRange" min="0" max="100" step="5">
                            <div class="d-flex justify-content-between">
                                <span>0%</span>
                                <span id="progressValue">50%</span>
                                <span>100%</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="progressStatus">
                                <option value="pending">Not Started</option>
                                <option value="inprogress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="delayed">Delayed</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Update Notes</label>
                            <textarea class="form-control" id="progressNotes" rows="3" 
                                      placeholder="Describe what has been accomplished"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Evidence (Optional)</label>
                            <input type="file" class="form-control" id="progressEvidence" 
                                   accept="image/*,.pdf,.doc,.docx">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="saveProgress">Update Progress</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // Sample Imihigo data
        let imihigoData = [
            {
                id: 1,
                title: "Complete Home Kitchen Renovation",
                type: "family",
                category: "Family Development",
                assignedTo: "All Members",
                description: "Renovate kitchen with new cabinets and countertops",
                startDate: "2024-01-15",
                targetDate: "2024-06-30",
                progress: 75,
                status: "inprogress",
                priority: "high"
            },
            {
                id: 2,
                title: "Save 500,000 RWF for Education",
                type: "family",
                category: "Economic Growth",
                assignedTo: "All Members",
                description: "Monthly savings for children's education fund",
                startDate: "2024-01-01",
                targetDate: "2024-12-31",
                progress: 40,
                status: "inprogress",
                priority: "high"
            },
            {
                id: 3,
                title: "Achieve First Division in National Exams",
                type: "individual",
                category: "Education",
                assignedTo: "Eric M.",
                description: "Study plan and academic performance improvement",
                startDate: "2024-02-01",
                targetDate: "2024-11-30",
                progress: 60,
                status: "inprogress",
                priority: "medium"
            },
            {
                id: 4,
                title: "Start Home Vegetable Garden",
                type: "family",
                category: "Agriculture",
                assignedTo: "All Members",
                description: "Establish sustainable vegetable garden for home consumption",
                startDate: "2024-03-01",
                targetDate: "2024-05-31",
                progress: 100,
                status: "completed",
                priority: "medium"
            },
            {
                id: 5,
                title: "Monthly Family Health Check-ups",
                type: "family",
                category: "Health & Wellness",
                assignedTo: "All Members",
                description: "Regular medical check-ups for all family members",
                startDate: "2024-01-01",
                targetDate: "2024-12-31",
                progress: 25,
                status: "pending",
                priority: "low"
            }
        ];
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize calendar
            initCalendar();
            
            // Load Imihigo data
            loadImihigoData();
            
            // Update stats
            updateStats();
            
            // Setup event listeners
            setupEventListeners();
        });
        
        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                height: 350,
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                events: imihigoData.map(imihigo => ({
                    title: imihigo.title,
                    start: imihigo.startDate,
                    end: imihigo.targetDate,
                    backgroundColor: getStatusColor(imihigo.status),
                    borderColor: getStatusColor(imihigo.status)
                }))
            });
            calendar.render();
        }
        
        function loadImihigoData() {
            const allContainer = document.getElementById('imihigoList');
            const individualContainer = document.getElementById('individualImihigoList');
            const familyContainer = document.getElementById('familyImihigoList');
            
            allContainer.innerHTML = '';
            individualContainer.innerHTML = '';
            familyContainer.innerHTML = '';
            
            imihigoData.forEach(imihigo => {
                const card = createImihigoCard(imihigo);
                allContainer.appendChild(card.cloneNode(true));
                
                if (imihigo.type === 'individual') {
                    individualContainer.appendChild(card.cloneNode(true));
                } else {
                    familyContainer.appendChild(card.cloneNode(true));
                }
            });
        }
        
        function createImihigoCard(imihigo) {
            const card = document.createElement('div');
            card.className = 'imihigo-card';
            card.innerHTML = `
                <div class="imihigo-header ${imihigo.type === 'individual' ? 'imihigo-individual' : 'imihigo-family'}">
                    <div>
                        <h6 class="mb-0">${imihigo.title}</h6>
                        <small>${imihigo.category} â€¢ ${imihigo.type === 'individual' ? 'Individual' : 'Family Shared'}</small>
                    </div>
                    <span class="imihigo-status status-${imihigo.status}">
                        ${imihigo.status.charAt(0).toUpperCase() + imihigo.status.slice(1)}
                    </span>
                </div>
                <div class="card-body">
                    <p class="card-text">${imihigo.description}</p>
                    
                    <div class="mb-2">
                        <small><strong>Assigned to:</strong> ${imihigo.assignedTo}</small>
                    </div>
                    
                    <div class="mb-3">
                        <small><strong>Target Date:</strong> ${new Date(imihigo.targetDate).toLocaleDateString()}</small>
                    </div>
                    
                    <div class="progress-indicator">
                        <div class="progress-bar bg-${getProgressColor(imihigo.progress)}" style="width: ${imihigo.progress}%"></div>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small>Progress: ${imihigo.progress}%</small>
                        <small>Priority: <span class="text-${getPriorityColor(imihigo.priority)}">${imihigo.priority}</span></small>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-3">
                        <button class="btn btn-sm btn-outline-success" onclick="updateImihigoProgress(${imihigo.id})">
                            <i class="bi bi-arrow-clockwise"></i> Update
                        </button>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewImihigoDetails(${imihigo.id})">
                            <i class="bi bi-eye"></i> Details
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteImihigo(${imihigo.id})">
                            <i class="bi bi-trash"></i> Remove
                        </button>
                    </div>
                </div>
            `;
            return card;
        }
        
        function setupEventListeners() {
            // Imihigo type change
            document.getElementById('imihigoType').addEventListener('change', function() {
                const assignedTo = document.getElementById('assignedTo');
                if (this.value === 'individual') {
                    assignedTo.disabled = false;
                } else {
                    assignedTo.disabled = true;
                    assignedTo.value = 'all';
                }
            });
            
            // Save Imihigo
            document.getElementById('saveImihigo').addEventListener('click', function() {
                const type = document.getElementById('imihigoType').value;
                const title = document.getElementById('imihigoTitle').value.trim();
                const description = document.getElementById('imihigoDescription').value.trim();
                const startDate = document.getElementById('startDate').value;
                const targetDate = document.getElementById('targetDate').value;
                
                if (type && title && description && startDate && targetDate) {
                    const newImihigo = {
                        id: imihigoData.length + 1,
                        title: title,
                        type: type,
                        category: document.getElementById('category').value,
                        assignedTo: type === 'individual' ? document.getElementById('assignedTo').value : 'All Members',
                        description: description,
                        startDate: startDate,
                        targetDate: targetDate,
                        progress: 0,
                        status: 'pending',
                        priority: document.getElementById('priority').value
                    };
                    
                    imihigoData.push(newImihigo);
                    loadImihigoData();
                    updateStats();
                    
                    // Close modal and reset form
                    const modal = bootstrap.Modal.getInstance(document.getElementById('addImihigoModal'));
                    modal.hide();
                    document.getElementById('imihigoForm').reset();
                    
                    alert('Imihigo added successfully!');
                } else {
                    alert('Please fill all required fields.');
                }
            });
            
            // Progress range update
            document.getElementById('progressRange').addEventListener('input', function() {
                document.getElementById('progressValue').textContent = this.value + '%';
            });
            
            // Save progress
            document.getElementById('saveProgress').addEventListener('click', function() {
                const imihigoId = document.getElementById('imihigoId').value;
                const progress = document.getElementById('progressRange').value;
                const status = document.getElementById('progressStatus').value;
                
                const imihigo = imihigoData.find(i => i.id == imihigoId);
                if (imihigo) {
                    imihigo.progress = parseInt(progress);
                    imihigo.status = status;
                    
                    loadImihigoData();
                    updateStats();
                    
                    const modal = bootstrap.Modal.getInstance(document.getElementById('updateProgressModal'));
                    modal.hide();
                    
                    alert('Progress updated successfully!');
                }
            });
        }
        
        function updateImihigoProgress(id) {
            const imihigo = imihigoData.find(i => i.id == id);
            if (imihigo) {
                document.getElementById('imihigoId').value = id;
                document.getElementById('progressRange').value = imihigo.progress;
                document.getElementById('progressValue').textContent = imihigo.progress + '%';
                document.getElementById('progressStatus').value = imihigo.status;
                
                const modal = new bootstrap.Modal(document.getElementById('updateProgressModal'));
                modal.show();
            }
        }
        
        function viewImihigoDetails(id) {
            const imihigo = imihigoData.find(i => i.id == id);
            if (imihigo) {
                alert(`Imihigo Details:\n\nTitle: ${imihigo.title}\nType: ${imihigo.type}\nCategory: ${imihigo.category}\nDescription: ${imihigo.description}\nProgress: ${imihigo.progress}%\nStatus: ${imihigo.status}\nTarget Date: ${new Date(imihigo.targetDate).toLocaleDateString()}`);
            }
        }
        
        function deleteImihigo(id) {
            if (confirm('Are you sure you want to delete this Imihigo?')) {
                imihigoData = imihigoData.filter(i => i.id !== id);
                loadImihigoData();
                updateStats();
                alert('Imihigo deleted successfully!');
            }
        }
        
        function updateStats() {
            const total = imihigoData.length;
            const completed = imihigoData.filter(i => i.status === 'completed').length;
            const inProgress = imihigoData.filter(i => i.status === 'inprogress').length;
            const delayed = imihigoData.filter(i => i.status === 'delayed').length;
            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
            const avgProgress = total > 0 ? Math.round(imihigoData.reduce((sum, i) => sum + i.progress, 0) / total) : 0;
            
            document.getElementById('totalImihigo').textContent = total;
            document.getElementById('completedImihigo').textContent = completed;
            document.getElementById('inProgressImihigo').textContent = inProgress;
            document.getElementById('delayedImihigo').textContent = delayed;
            document.getElementById('completionRate').textContent = completionRate + '%';
            document.getElementById('avgProgress').textContent = avgProgress + '%';
        }
        
        function getStatusColor(status) {
            const colors = {
                'pending': '#ffc107',
                'inprogress': '#0dcaf0',
                'completed': '#198754',
                'delayed': '#dc3545'
            };
            return colors[status] || '#6c757d';
        }
        
        function getProgressColor(progress) {
            if (progress >= 80) return 'success';
            if (progress >= 50) return 'info';
            if (progress >= 20) return 'warning';
            return 'danger';
        }
        
        function getPriorityColor(priority) {
            const colors = {
                'high': 'danger',
                'medium': 'warning',
                'low': 'success'
            };
            return colors[priority] || 'secondary';
        }
        
        function updateAllProgress() {
            alert('Bulk progress update feature coming soon!');
        }
        
        function generateReport() {
            alert('Report generated successfully!');
        }
        
        function shareAchievements() {
            alert('Achievements shared with community!');
        }
    </script>
</body>
</html>